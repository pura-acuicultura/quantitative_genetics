<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Random drift in the idealized population | A laboratory manual for quantitative genetics</title>
  <meta name="description" content="Chapter 3 Random drift in the idealized population | A laboratory manual for quantitative genetics" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Random drift in the idealized population | A laboratory manual for quantitative genetics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Random drift in the idealized population | A laboratory manual for quantitative genetics" />
  
  
  

<meta name="author" content="James Webb, PhD" />


<meta name="date" content="2024-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linkage-disequilibrium.html"/>
<link rel="next" href="systems-of-close-inbreeding.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative genetics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Genetic constitution of a population</a></li>
<li class="chapter" data-level="2" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html"><i class="fa fa-check"></i><b>2</b> Linkage disequilibrium</a>
<ul>
<li class="chapter" data-level="2.1" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#getting-started"><i class="fa fa-check"></i><b>2.2</b> Getting started</a></li>
<li class="chapter" data-level="2.3" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#development-of-the-populations"><i class="fa fa-check"></i><b>2.3</b> Development of the populations</a></li>
<li class="chapter" data-level="2.4" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#un-linked-loci"><i class="fa fa-check"></i><b>2.4</b> Un-linked loci</a></li>
<li class="chapter" data-level="2.5" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#closely-linked-loci"><i class="fa fa-check"></i><b>2.5</b> Closely linked loci</a></li>
<li class="chapter" data-level="2.6" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#conclusion"><i class="fa fa-check"></i><b>2.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html"><i class="fa fa-check"></i><b>3</b> Random drift in the idealized population</a>
<ul>
<li class="chapter" data-level="3.1" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#flexible-parameters"><i class="fa fa-check"></i><b>3.2</b> Flexible parameters</a></li>
<li class="chapter" data-level="3.3" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#making-a-for-loop"><i class="fa fa-check"></i><b>3.3</b> Making a For Loop</a></li>
<li class="chapter" data-level="3.4" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#plotting-the-results"><i class="fa fa-check"></i><b>3.4</b> Plotting the results</a></li>
<li class="chapter" data-level="3.5" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#conclusion-1"><i class="fa fa-check"></i><b>3.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html"><i class="fa fa-check"></i><b>4</b> Systems of close inbreeding</a>
<ul>
<li class="chapter" data-level="4.1" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#through-the-recurrence-equation"><i class="fa fa-check"></i><b>4.2</b> Through the recurrence equation</a></li>
<li class="chapter" data-level="4.3" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#through-coancestry"><i class="fa fa-check"></i><b>4.3</b> Through coancestry</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#develop-a-pedigree-and-kinship-matrix"><i class="fa fa-check"></i><b>4.3.1</b> Develop a pedigree and kinship matrix</a></li>
<li class="chapter" data-level="4.3.2" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#merge-the-pedigree-and-kinship-matrix"><i class="fa fa-check"></i><b>4.3.2</b> Merge the pedigree and kinship matrix</a></li>
<li class="chapter" data-level="4.3.3" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#compare-with-the-recurrence-equation"><i class="fa fa-check"></i><b>4.3.3</b> Compare with the recurrence equation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#conclusion-2"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A laboratory manual for quantitative genetics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="random-drift-in-the-idealized-population" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Random drift in the idealized population<a href="random-drift-in-the-idealized-population.html#random-drift-in-the-idealized-population" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction<a href="random-drift-in-the-idealized-population.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This exercise makes use of equation 3.1 to produce a series of figures depicting random drift. The code is written such that key parameters can be changed and the results observed. Only the <code>tidyverse</code> library is used for the exercise. <code>flextable</code> was used for generating the tables in Rmarkdown.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="random-drift-in-the-idealized-population.html#cb17-1" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb17-2"><a href="random-drift-in-the-idealized-population.html#cb17-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="flexible-parameters" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Flexible parameters<a href="random-drift-in-the-idealized-population.html#flexible-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we look closely at Figure 3.1 and Equation 3.1 we can devise a set of parameters whose effects will be interesting to explore. Both axis of the figure, <em>generation</em> and <em>q frequency</em>, are obvious choices. <em>Population size</em> and the <em>number of lines</em> might also prove interesting. These parameters with general starting values are defined as variables below.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="random-drift-in-the-idealized-population.html#cb18-1" tabindex="-1"></a>generations <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb18-2"><a href="random-drift-in-the-idealized-population.html#cb18-2" tabindex="-1"></a>q_0 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb18-3"><a href="random-drift-in-the-idealized-population.html#cb18-3" tabindex="-1"></a>pop_size <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb18-4"><a href="random-drift-in-the-idealized-population.html#cb18-4" tabindex="-1"></a>lines <span class="ot">&lt;-</span> <span class="dv">10</span></span></code></pre></div>
<p>The challenge is a little more complex than simply substituting values into equation 3.1. One must remember that we can only predict the magnitude of the change in gene frequency and not the direction. As such, we need to step the lines forward through each generation using the results of the previous generation. A <code>for loop</code> will help us do this.</p>
</div>
<div id="making-a-for-loop" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Making a For Loop<a href="random-drift-in-the-idealized-population.html#making-a-for-loop" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before starting the <code>for loop</code> we need to make a data frame to store the data. For each line, a data frame of 7x columns and as many rows as generations defined in the parameters (NB: initially 20). The <em>gen</em> column provides the <strong>generation number</strong>. <em>q_0</em> and <em>p_0</em> provide the <strong>gene frequencies</strong>. <em>N</em> equates to the <strong>population size</strong> of each line. The <strong>variance</strong>, <em>var</em>, <strong>standard deviation</strong>, <em>sd</em>, and the <strong>change in gene frequency</strong>, <em>diff</em>, columns are calculated fields that will be filled in by the <code>for loop</code>. The first few columns of the data frame are shown for reference. Zero values have yet to be determined.</p>
<div class="tabwid"><style>.cl-ee4f1a18{}.cl-ee4342c4{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ee47e14e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ee47fd32{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee47fd46{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee47fd47{width:0.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-ee4f1a18'><thead><tr style="overflow-wrap:break-word;"><th class="cl-ee47fd32"><p class="cl-ee47e14e"><span class="cl-ee4342c4">gen</span></p></th><th class="cl-ee47fd32"><p class="cl-ee47e14e"><span class="cl-ee4342c4">q_0</span></p></th><th class="cl-ee47fd32"><p class="cl-ee47e14e"><span class="cl-ee4342c4">p_0</span></p></th><th class="cl-ee47fd32"><p class="cl-ee47e14e"><span class="cl-ee4342c4">N</span></p></th><th class="cl-ee47fd32"><p class="cl-ee47e14e"><span class="cl-ee4342c4">var</span></p></th><th class="cl-ee47fd32"><p class="cl-ee47e14e"><span class="cl-ee4342c4">sd</span></p></th><th class="cl-ee47fd32"><p class="cl-ee47e14e"><span class="cl-ee4342c4">diff</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">100</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">1</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">100</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">2</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">100</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">3</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">100</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">4</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">100</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd46"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee47fd47"><p class="cl-ee47e14e"><span class="cl-ee4342c4">5</span></p></td><td class="cl-ee47fd47"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd47"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0.5</span></p></td><td class="cl-ee47fd47"><p class="cl-ee47e14e"><span class="cl-ee4342c4">100</span></p></td><td class="cl-ee47fd47"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd47"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td><td class="cl-ee47fd47"><p class="cl-ee47e14e"><span class="cl-ee4342c4">0</span></p></td></tr></tbody></table></div>
<p>Data frame setup and the <code>for loop</code> are nested inside a function names <code>random_drift</code>. The function accepts a vector of population sizes, <em>N</em>, as input, and produces the complete data frame described earlier. For reference, the code is provided below.</p>
<p>The data frame, <em>df</em>, is first written. The <code>for loop</code> is then specified to run from 1 to the number of generations + 1. The extra generation is added to accommodate the base, or 0, generation.</p>
<p>The <code>for loop</code> begins with a few <code>if</code> functions. The first <code>if</code> function updates the frequency of <em>q_0</em> for every generation other than the 0 generation. If generation is greater than 0 then <em>q_0</em> is adjusted based on the change in gene frequency determined in the preceding generation. The second and third <code>if</code> functions handle the loss or fixation of the <em>q</em> allele should this occur through random drift. Once the calculated frequency of <em>q</em> either goes below 0 or above 1, the frequency will remain at either 0 or 1 in the line.</p>
<p>After the <code>if</code> functions, <em>p_0</em> is calculated as <em>(1 - q_0)</em> in line 4. This is important since <em>q_0</em> is re-written for every generation above 0. The variance of the change in gene frequency using equation 3.2 is then calculated in line 5. Next, the standard deviation is derived from the variance in line 6. Finally, the predicted change in gene frequency is modeled in line 7. Since dispersive processes have no direction, and the calculated variance is not a measure of magnitude for a single line, the prediction takes advantage of the base R function, <code>rnorm</code>. The function pulls a defined number of samples from a normal distribution with a specified mean and standard deviation. For our purposes, a single sample is drawn from a normal distribution with a mean of 0 and a standard deviation equating to the variance of gene frequencies in the current generation. Because a mean of 0 is used, the predicted change in frequency can be negative or positive. The prediction is written to the <em>diff</em> column where it can be used to adjust the frequency of <em>q</em> in the following generation.</p>
<p>The <code>return(df)</code> function specifies the desired output from the <code>random_drift</code> function.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="random-drift-in-the-idealized-population.html#cb19-1" tabindex="-1"></a>random_drift <span class="ot">&lt;-</span> <span class="cf">function</span>(pop_size){</span>
<span id="cb19-2"><a href="random-drift-in-the-idealized-population.html#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="random-drift-in-the-idealized-population.html#cb19-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gen =</span> <span class="dv">0</span><span class="sc">:</span>generations,</span>
<span id="cb19-4"><a href="random-drift-in-the-idealized-population.html#cb19-4" tabindex="-1"></a>                 <span class="at">q_0 =</span> q_0,</span>
<span id="cb19-5"><a href="random-drift-in-the-idealized-population.html#cb19-5" tabindex="-1"></a>                 <span class="at">p_0 =</span> <span class="dv">0</span>,</span>
<span id="cb19-6"><a href="random-drift-in-the-idealized-population.html#cb19-6" tabindex="-1"></a>                 <span class="at">N =</span> pop_size,</span>
<span id="cb19-7"><a href="random-drift-in-the-idealized-population.html#cb19-7" tabindex="-1"></a>                 <span class="at">var =</span> <span class="dv">0</span>,</span>
<span id="cb19-8"><a href="random-drift-in-the-idealized-population.html#cb19-8" tabindex="-1"></a>                 <span class="at">sd =</span> <span class="dv">0</span>,</span>
<span id="cb19-9"><a href="random-drift-in-the-idealized-population.html#cb19-9" tabindex="-1"></a>                 <span class="at">diff =</span> <span class="dv">0</span>)</span>
<span id="cb19-10"><a href="random-drift-in-the-idealized-population.html#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="random-drift-in-the-idealized-population.html#cb19-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(generations<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb19-12"><a href="random-drift-in-the-idealized-population.html#cb19-12" tabindex="-1"></a>    </span>
<span id="cb19-13"><a href="random-drift-in-the-idealized-population.html#cb19-13" tabindex="-1"></a>    <span class="cf">if</span>(df<span class="sc">$</span>gen[i] <span class="sc">&gt;</span> <span class="dv">0</span>){df<span class="sc">$</span>q_0[i] <span class="ot">&lt;-</span> df<span class="sc">$</span>q_0[i<span class="dv">-1</span>] <span class="sc">+</span> df<span class="sc">$</span>diff[i<span class="dv">-1</span>]} <span class="co"># line 1</span></span>
<span id="cb19-14"><a href="random-drift-in-the-idealized-population.html#cb19-14" tabindex="-1"></a>    <span class="cf">if</span>(df<span class="sc">$</span>q_0[i] <span class="sc">&lt;=</span> <span class="dv">0</span>) {df<span class="sc">$</span>q_0[i] <span class="ot">&lt;-</span> <span class="dv">0</span>} <span class="co"># line 2</span></span>
<span id="cb19-15"><a href="random-drift-in-the-idealized-population.html#cb19-15" tabindex="-1"></a>    <span class="cf">if</span>(df<span class="sc">$</span>q_0[i] <span class="sc">&gt;=</span> <span class="dv">1</span>) {df<span class="sc">$</span>q_0[i] <span class="ot">&lt;-</span> <span class="dv">1</span>} <span class="co"># line 3</span></span>
<span id="cb19-16"><a href="random-drift-in-the-idealized-population.html#cb19-16" tabindex="-1"></a>    </span>
<span id="cb19-17"><a href="random-drift-in-the-idealized-population.html#cb19-17" tabindex="-1"></a>    df<span class="sc">$</span>p_0[i] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>q_0[i] <span class="co"># line 4</span></span>
<span id="cb19-18"><a href="random-drift-in-the-idealized-population.html#cb19-18" tabindex="-1"></a>    df<span class="sc">$</span>var[i] <span class="ot">&lt;-</span> df<span class="sc">$</span>q_0[i] <span class="sc">*</span> df<span class="sc">$</span>p_0[i] <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> df<span class="sc">$</span>N[i]) <span class="co"># line 5</span></span>
<span id="cb19-19"><a href="random-drift-in-the-idealized-population.html#cb19-19" tabindex="-1"></a>    df<span class="sc">$</span>sd[i] <span class="ot">&lt;-</span> (df<span class="sc">$</span>var[i])<span class="sc">^</span><span class="fl">0.5</span> <span class="co"># line 6</span></span>
<span id="cb19-20"><a href="random-drift-in-the-idealized-population.html#cb19-20" tabindex="-1"></a>    df<span class="sc">$</span>diff[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> df<span class="sc">$</span>sd[i]) <span class="co"># line 7</span></span>
<span id="cb19-21"><a href="random-drift-in-the-idealized-population.html#cb19-21" tabindex="-1"></a>    </span>
<span id="cb19-22"><a href="random-drift-in-the-idealized-population.html#cb19-22" tabindex="-1"></a>  }</span>
<span id="cb19-23"><a href="random-drift-in-the-idealized-population.html#cb19-23" tabindex="-1"></a> <span class="fu">return</span>(df)</span>
<span id="cb19-24"><a href="random-drift-in-the-idealized-population.html#cb19-24" tabindex="-1"></a>}</span></code></pre></div>
<p>The following code runs the function. An <code>lapply</code> function is used to run <code>random_drift</code> for the population size and number of lines specified. The <code>rbind</code> within a <code>do.call</code> function simply takes all the data frame outputs and binds them into a single data frame. That last bit of code simply adds a <em>line</em> identification number for graphing purposes.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="random-drift-in-the-idealized-population.html#cb20-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,</span>
<span id="cb20-2"><a href="random-drift-in-the-idealized-population.html#cb20-2" tabindex="-1"></a>              <span class="fu">lapply</span>(<span class="fu">rep</span>(pop_size, lines),</span>
<span id="cb20-3"><a href="random-drift-in-the-idealized-population.html#cb20-3" tabindex="-1"></a>                     <span class="at">FUN =</span> random_drift)) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="random-drift-in-the-idealized-population.html#cb20-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>lines, <span class="at">each =</span> generations <span class="sc">+</span> <span class="dv">1</span>))</span></code></pre></div>
<p>Data pertaining to the first line is shown below. One can see how the <code>for loop</code> builds out the data from generation 0 onward. Starting at the specified gene frequency, the variance is calculated and the change in gene frequency is predicted. The prediction is then applied to the next generation and the calculations repeated.</p>
<div class="tabwid"><style>.cl-ee86d6b0{}.cl-ee7903b4{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ee7e99e6{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ee7eb6c4{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee7eb6c5{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee7eb6ce{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-ee86d6b0'><thead><tr style="overflow-wrap:break-word;"><th class="cl-ee7eb6c4"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">gen</span></p></th><th class="cl-ee7eb6c4"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">q_0</span></p></th><th class="cl-ee7eb6c4"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">p_0</span></p></th><th class="cl-ee7eb6c4"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">N</span></p></th><th class="cl-ee7eb6c4"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">var</span></p></th><th class="cl-ee7eb6c4"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">sd</span></p></th><th class="cl-ee7eb6c4"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">diff</span></p></th><th class="cl-ee7eb6c4"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">line</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5000000</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5000000</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001250000</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03535534</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.070796851</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5707969</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4292031</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001224939</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03499913</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.036542475</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">2</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5342544</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4657456</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001244133</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03527227</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.016755211</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">3</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5174992</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4825008</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001248469</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03533368</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.004618980</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">4</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5128802</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4871198</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001249171</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03534361</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.025099044</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">5</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4877811</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5122189</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001249253</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03534478</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.014039025</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">6</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5018202</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4981798</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001249983</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03535510</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.003591051</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">7</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5054112</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4945888</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001249854</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03535327</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.010919394</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">8</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5163306</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4836694</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001248667</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03533648</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.015693384</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">9</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5006372</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4993628</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001249998</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03535531</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.049150173</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">10</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4514871</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5485129</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001238232</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03518853</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.017061040</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">11</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4344260</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5655740</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001228500</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03504997</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.017878071</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">12</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4165479</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5834521</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001215179</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03485941</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.026908380</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">13</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.3896396</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.6103604</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001189103</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03448337</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.001850899</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">14</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.3877887</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.6122113</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001187043</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03445349</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.043043373</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">15</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4308320</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5691680</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001226079</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03501541</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.011927576</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">16</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4427596</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5572404</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001233618</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03512289</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">-0.012217919</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">17</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4305417</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5694583</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001225878</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03501254</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.030443122</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">18</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4609848</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5390152</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001242389</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03524754</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.028158941</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">19</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4891438</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5108562</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001249411</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03534700</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.070786466</span></p></td><td class="cl-ee7eb6c5"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee7eb6ce"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">20</span></p></td><td class="cl-ee7eb6ce"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.5599302</span></p></td><td class="cl-ee7eb6ce"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.4400698</span></p></td><td class="cl-ee7eb6ce"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">100</span></p></td><td class="cl-ee7eb6ce"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.001232042</span></p></td><td class="cl-ee7eb6ce"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.03510045</span></p></td><td class="cl-ee7eb6ce"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">0.091641053</span></p></td><td class="cl-ee7eb6ce"><p class="cl-ee7e99e6"><span class="cl-ee7903b4">1</span></p></td></tr></tbody></table></div>
</div>
<div id="plotting-the-results" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Plotting the results<a href="random-drift-in-the-idealized-population.html#plotting-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following code produces a plot similar to Figure 3.1. The base population <em>q</em> frequency is shown as a dashed line. Each line is given a different color. The biggest difference between the plot and Figure 3.1 is the lack of selection in the simulation.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="random-drift-in-the-idealized-population.html#cb21-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="random-drift-in-the-idealized-population.html#cb21-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line =</span> <span class="fu">factor</span>(line)) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="random-drift-in-the-idealized-population.html#cb21-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="random-drift-in-the-idealized-population.html#cb21-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> q_0, <span class="at">group =</span> line, <span class="at">color =</span> line),</span>
<span id="cb21-5"><a href="random-drift-in-the-idealized-population.html#cb21-5" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="random-drift-in-the-idealized-population.html#cb21-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb21-7"><a href="random-drift-in-the-idealized-population.html#cb21-7" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="random-drift-in-the-idealized-population.html#cb21-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, generations),</span>
<span id="cb21-9"><a href="random-drift-in-the-idealized-population.html#cb21-9" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, generations, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-10"><a href="random-drift-in-the-idealized-population.html#cb21-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>,</span>
<span id="cb21-11"><a href="random-drift-in-the-idealized-population.html#cb21-11" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="random-drift-in-the-idealized-population.html#cb21-12" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;generation&#39;</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="random-drift-in-the-idealized-population.html#cb21-13" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;frequency of q allele&#39;</span>) <span class="sc">+</span></span>
<span id="cb21-14"><a href="random-drift-in-the-idealized-population.html#cb21-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-15"><a href="random-drift-in-the-idealized-population.html#cb21-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/CO3_R1_df_plot-1.png" width="672" /></p>
</div>
<div id="conclusion-1" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Conclusion<a href="random-drift-in-the-idealized-population.html#conclusion-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With an understanding of how the simulation works, alter the starting patterns and observe the change in results. If you were really ambitious, the code is a good starting point for an interactive <code>Rshiny</code> app. Well be revisiting all these topics in fuutre exercises.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linkage-disequilibrium.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="systems-of-close-inbreeding.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pura-acuicultura/quantitative_genetics/edit/main/03-random_drift_1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/pura-acuicultura/quantitative_genetics/blob/main/03-random_drift_1.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
