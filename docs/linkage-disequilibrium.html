<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Linkage disequilibrium | A laboratory manual for quantitative genetics</title>
  <meta name="description" content="Chapter 2 Linkage disequilibrium | A laboratory manual for quantitative genetics" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Linkage disequilibrium | A laboratory manual for quantitative genetics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Linkage disequilibrium | A laboratory manual for quantitative genetics" />
  
  
  

<meta name="author" content="James Webb, PhD" />


<meta name="date" content="2024-03-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="random-drift-in-the-idealized-population.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative genetics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Genetic constitution of a population</a></li>
<li class="chapter" data-level="2" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html"><i class="fa fa-check"></i><b>2</b> Linkage disequilibrium</a>
<ul>
<li class="chapter" data-level="2.1" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#getting-started"><i class="fa fa-check"></i><b>2.2</b> Getting started</a></li>
<li class="chapter" data-level="2.3" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#development-of-the-populations"><i class="fa fa-check"></i><b>2.3</b> Development of the populations</a></li>
<li class="chapter" data-level="2.4" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#un-linked-loci"><i class="fa fa-check"></i><b>2.4</b> Un-linked loci</a></li>
<li class="chapter" data-level="2.5" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#closely-linked-loci"><i class="fa fa-check"></i><b>2.5</b> Closely linked loci</a></li>
<li class="chapter" data-level="2.6" data-path="linkage-disequilibrium.html"><a href="linkage-disequilibrium.html#conclusion"><i class="fa fa-check"></i><b>2.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html"><i class="fa fa-check"></i><b>3</b> Random drift in the idealized population</a>
<ul>
<li class="chapter" data-level="3.1" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#flexible-parameters"><i class="fa fa-check"></i><b>3.2</b> Flexible parameters</a></li>
<li class="chapter" data-level="3.3" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#making-a-for-loop"><i class="fa fa-check"></i><b>3.3</b> Making a For Loop</a></li>
<li class="chapter" data-level="3.4" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#plotting-the-results"><i class="fa fa-check"></i><b>3.4</b> Plotting the results</a></li>
<li class="chapter" data-level="3.5" data-path="random-drift-in-the-idealized-population.html"><a href="random-drift-in-the-idealized-population.html#conclusion-1"><i class="fa fa-check"></i><b>3.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html"><i class="fa fa-check"></i><b>4</b> Systems of close inbreeding</a>
<ul>
<li class="chapter" data-level="4.1" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#through-the-recurrence-equation"><i class="fa fa-check"></i><b>4.2</b> Through the recurrence equation</a></li>
<li class="chapter" data-level="4.3" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#through-coancestry"><i class="fa fa-check"></i><b>4.3</b> Through coancestry</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#develop-a-pedigree-and-kinship-matrix"><i class="fa fa-check"></i><b>4.3.1</b> Develop a pedigree and kinship matrix</a></li>
<li class="chapter" data-level="4.3.2" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#merge-the-pedigree-and-kinship-matrix"><i class="fa fa-check"></i><b>4.3.2</b> Merge the pedigree and kinship matrix</a></li>
<li class="chapter" data-level="4.3.3" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#compare-with-the-recurrence-equation"><i class="fa fa-check"></i><b>4.3.3</b> Compare with the recurrence equation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="systems-of-close-inbreeding.html"><a href="systems-of-close-inbreeding.html#conclusion-2"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="change-of-base.html"><a href="change-of-base.html"><i class="fa fa-check"></i><b>5</b> Change of base</a>
<ul>
<li class="chapter" data-level="5.1" data-path="change-of-base.html"><a href="change-of-base.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="change-of-base.html"><a href="change-of-base.html#development-of-the-base-population"><i class="fa fa-check"></i><b>5.2</b> Development of the base population</a></li>
<li class="chapter" data-level="5.3" data-path="change-of-base.html"><a href="change-of-base.html#breed-from-a-to-b-from-b-to-x"><i class="fa fa-check"></i><b>5.3</b> Breed from A-to-B &amp; from B-to-X</a></li>
<li class="chapter" data-level="5.4" data-path="change-of-base.html"><a href="change-of-base.html#get-the-complete-a-to-x-pedigree"><i class="fa fa-check"></i><b>5.4</b> Get the complete A-to-X pedigree</a></li>
<li class="chapter" data-level="5.5" data-path="change-of-base.html"><a href="change-of-base.html#calculate-inbreeding-for-a-to-b-b-to-x"><i class="fa fa-check"></i><b>5.5</b> Calculate inbreeding for A-to-B &amp; B-to-X</a></li>
<li class="chapter" data-level="5.6" data-path="change-of-base.html"><a href="change-of-base.html#mathematical-change-of-base-population"><i class="fa fa-check"></i><b>5.6</b> Mathematical change of base population</a></li>
<li class="chapter" data-level="5.7" data-path="change-of-base.html"><a href="change-of-base.html#confirm-the-derived-result-with-actual-results"><i class="fa fa-check"></i><b>5.7</b> Confirm the derived result with actual results</a></li>
<li class="chapter" data-level="5.8" data-path="change-of-base.html"><a href="change-of-base.html#conclusion-3"><i class="fa fa-check"></i><b>5.8</b> Conclusion</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A laboratory manual for quantitative genetics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linkage-disequilibrium" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Linkage disequilibrium<a href="linkage-disequilibrium.html#linkage-disequilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Introduction<a href="linkage-disequilibrium.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When considered independently, individual loci can reach equilibrium after one generation of random breeding. However, when considered jointly, the number of generations needed for two or more loci to reach equilibrium depends on the recombination frequency, and as such, the physical map positions of the loci themselves. Here, a brief genetic simulation is performed to demonstrate the relationship between physical map position, recombination frequency, and linkage disequilibrium.</p>
</div>
<div id="getting-started" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Getting started<a href="linkage-disequilibrium.html#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>AlphaSimR was used to perform the simulation. Tidyverse tools were used for general data wrangling, manipulation, and plotting.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="linkage-disequilibrium.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(AlphaSimR)</span>
<span id="cb1-2"><a href="linkage-disequilibrium.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-3"><a href="linkage-disequilibrium.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="linkage-disequilibrium.html#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="linkage-disequilibrium.html#cb1-5" tabindex="-1"></a><span class="fu">set_flextable_defaults</span>(<span class="at">fonts_ignore=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="development-of-the-populations" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Development of the populations<a href="linkage-disequilibrium.html#development-of-the-populations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Highly simplified genomes were simulated to observe the interaction between physical map location, recombination frequency, and linkage disequilibrium. The populations are generally based on ‘end of chapter’ problem 1.10. Individuals possess a single chromosome of 1 Morgan in length. The chromosome consists of 10 segregation sites with loci spaced 0.1 Morgans apart. Two distinct populations were made. <code>pop_ABC</code> is homozygous for all 1 alleles and <code>pop_abc</code> is homozygous for all 0 alleles. 1000 haplotypes, or 500 diploid individuals, were simulated for each population. Sexes were set systematically such that each population consists of 250 females and 250 males. The code specifying each population and the genetic map of a representative individual are shown below. Rows in the genetic maps specify the two gamete possibilities of individuals 1 and 501. Columns specify each of the 10 loci of the single chromosome genome of the individuals.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="linkage-disequilibrium.html#cb2-1" tabindex="-1"></a>pop_ABC <span class="ot">&lt;-</span> <span class="fu">newMapPop</span>(<span class="at">genMap =</span> <span class="fu">list</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">10</span>)),</span>
<span id="cb2-2"><a href="linkage-disequilibrium.html#cb2-2" tabindex="-1"></a>                     <span class="at">haplotypes =</span> <span class="fu">list</span>(<span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1000</span>, <span class="at">ncol =</span> <span class="dv">10</span>)))</span>
<span id="cb2-3"><a href="linkage-disequilibrium.html#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="linkage-disequilibrium.html#cb2-4" tabindex="-1"></a>SP <span class="ot">&lt;-</span> SimParam<span class="sc">$</span><span class="fu">new</span>(pop_ABC)</span>
<span id="cb2-5"><a href="linkage-disequilibrium.html#cb2-5" tabindex="-1"></a>SP <span class="ot">&lt;-</span> SP<span class="sc">$</span><span class="fu">setSexes</span>(<span class="st">&quot;yes_sys&quot;</span>)</span>
<span id="cb2-6"><a href="linkage-disequilibrium.html#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="linkage-disequilibrium.html#cb2-7" tabindex="-1"></a>pop_ABC <span class="ot">&lt;-</span> <span class="fu">newPop</span>(<span class="at">rawPop =</span> pop_ABC, <span class="at">simParam =</span> SP)</span></code></pre></div>
<div class="tabwid"><style>.cl-e136cbe4{}.cl-e11fa20c{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e129e3fc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e12a3afa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e12a3b18{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e12a3b22{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e12a3b23{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e12a3b2c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e12a3b36{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-e136cbe4'><thead><tr style="overflow-wrap:break-word;"><th class="cl-e12a3afa"><p class="cl-e129e3fc"><span class="cl-e11fa20c">Ind/Hap</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_01</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_02</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_03</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_04</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_05</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_06</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_07</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_08</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_09</span></p></th><th class="cl-e12a3b18"><p class="cl-e129e3fc"><span class="cl-e11fa20c">loc_10</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e12a3b22"><p class="cl-e129e3fc"><span class="cl-e11fa20c">1_1</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b23"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e12a3b2c"><p class="cl-e129e3fc"><span class="cl-e11fa20c">1_2</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td><td class="cl-e12a3b36"><p class="cl-e129e3fc"><span class="cl-e11fa20c">0</span></p></td></tr></tbody></table></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="linkage-disequilibrium.html#cb3-1" tabindex="-1"></a>pop_abc <span class="ot">&lt;-</span> <span class="fu">newMapPop</span>(<span class="at">genMap =</span> <span class="fu">list</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">10</span>)),</span>
<span id="cb3-2"><a href="linkage-disequilibrium.html#cb3-2" tabindex="-1"></a>                     <span class="at">haplotypes =</span> <span class="fu">list</span>(<span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">1000</span>, <span class="at">ncol =</span> <span class="dv">10</span>)))</span>
<span id="cb3-3"><a href="linkage-disequilibrium.html#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="linkage-disequilibrium.html#cb3-4" tabindex="-1"></a>pop_abc <span class="ot">&lt;-</span> <span class="fu">newPop</span>(<span class="at">rawPop =</span> pop_abc, <span class="at">simParam =</span> SP)</span></code></pre></div>
<div class="tabwid"><style>.cl-e199a8cc{}.cl-e1830da6{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e18c5dac{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e18cb766{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e18cb784{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e18cb78e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e18cb7a2{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e18cb7ac{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e18cb7ad{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-e199a8cc'><thead><tr style="overflow-wrap:break-word;"><th class="cl-e18cb766"><p class="cl-e18c5dac"><span class="cl-e1830da6">Ind/Hap</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_01</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_02</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_03</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_04</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_05</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_06</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_07</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_08</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_09</span></p></th><th class="cl-e18cb784"><p class="cl-e18c5dac"><span class="cl-e1830da6">loc_10</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e18cb78e"><p class="cl-e18c5dac"><span class="cl-e1830da6">501_1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7a2"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e18cb7ac"><p class="cl-e18c5dac"><span class="cl-e1830da6">501_2</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td><td class="cl-e18cb7ad"><p class="cl-e18c5dac"><span class="cl-e1830da6">1</span></p></td></tr></tbody></table></div>
<p>After specifying the two populations they were merged and crossed into a single ‘founder’ population. The function <code>randCross</code> was specified to perform 500 crosses each producing two offspring. This ‘idealized’ scenario results in 1000 offspring, the same number as the parent generation. Because the crosses are done at random and there are both females and males homozygous for both alleles, the founder population is a mixture of homozygous and heterozygous individuals.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="linkage-disequilibrium.html#cb4-1" tabindex="-1"></a>POP_m <span class="ot">&lt;-</span> <span class="fu">mergePops</span>(<span class="fu">list</span>(pop_ABC, pop_abc))</span>
<span id="cb4-2"><a href="linkage-disequilibrium.html#cb4-2" tabindex="-1"></a>POP_f <span class="ot">&lt;-</span> <span class="fu">randCross</span>(<span class="at">pop =</span> POP_m,</span>
<span id="cb4-3"><a href="linkage-disequilibrium.html#cb4-3" tabindex="-1"></a>                   <span class="at">nCrosses =</span> <span class="dv">500</span>,</span>
<span id="cb4-4"><a href="linkage-disequilibrium.html#cb4-4" tabindex="-1"></a>                   <span class="at">nProgeny =</span> <span class="dv">2</span>,</span>
<span id="cb4-5"><a href="linkage-disequilibrium.html#cb4-5" tabindex="-1"></a>                   <span class="at">balance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-6"><a href="linkage-disequilibrium.html#cb4-6" tabindex="-1"></a>                   <span class="at">parents =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-7"><a href="linkage-disequilibrium.html#cb4-7" tabindex="-1"></a>                   <span class="at">simParam =</span> SP)</span></code></pre></div>
<p>With the founder population specified 30 generations of random mating were simulated. First, a vector in the form of a list was made to a length of generations + 1. The founder population was then added as the first entry of the list. Next, a <code>for loop</code> was created to walk forward the generations using the <code>randCross()</code> function. As performed for the founders, each generation ‘replaced’ the 1000 individuals of the previous generation through 500 crosses, each resulting in two full sibs. Each population was stored sequentially in the vector <code>POP</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="linkage-disequilibrium.html#cb5-1" tabindex="-1"></a>POP <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">31</span>, <span class="at">mode =</span> <span class="st">&quot;list&quot;</span>)</span>
<span id="cb5-2"><a href="linkage-disequilibrium.html#cb5-2" tabindex="-1"></a>POP[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> POP_f</span>
<span id="cb5-3"><a href="linkage-disequilibrium.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="linkage-disequilibrium.html#cb5-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">31</span>) {</span>
<span id="cb5-5"><a href="linkage-disequilibrium.html#cb5-5" tabindex="-1"></a>  POP[[i]] <span class="ot">&lt;-</span> <span class="fu">randCross</span>(<span class="at">pop =</span> POP[[i <span class="sc">-</span> <span class="dv">1</span>]],</span>
<span id="cb5-6"><a href="linkage-disequilibrium.html#cb5-6" tabindex="-1"></a>                        <span class="at">nCrosses =</span> <span class="dv">500</span>,</span>
<span id="cb5-7"><a href="linkage-disequilibrium.html#cb5-7" tabindex="-1"></a>                        <span class="at">nProgeny =</span> <span class="dv">2</span>,</span>
<span id="cb5-8"><a href="linkage-disequilibrium.html#cb5-8" tabindex="-1"></a>                        <span class="at">balance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-9"><a href="linkage-disequilibrium.html#cb5-9" tabindex="-1"></a>                        <span class="at">parents =</span> <span class="cn">NULL</span>,</span>
<span id="cb5-10"><a href="linkage-disequilibrium.html#cb5-10" tabindex="-1"></a>                        <span class="at">simParam =</span> SP)</span>
<span id="cb5-11"><a href="linkage-disequilibrium.html#cb5-11" tabindex="-1"></a>}</span></code></pre></div>
<p>With all the populations stored, the haplotypes were needed for the analysis. A function was created acquire the happlotypes from each generation, add a few qualifiers, and wrangle them into a data frame for row binding and downstream analysis. At its core is the <code>pullSegSiteHaplo()</code> function which produces an ‘individual + haplotype’ x ‘chromosome + segregation site’ matrix. Here, the segregation sites were first renamed. The ‘individual + haplotype’ rownames were then made into separate columns. Finally, the generation number was added such that the founders were considered generation 0. Once the function was created, <code>lapply</code> was used to create a data frame for each of the 30 generations simulated. By placing the <code>lapply</code> under the command of <code>rbind</code> within <code>do.call</code>, the 30 data frames were returned as a single data frame.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="linkage-disequilibrium.html#cb6-1" tabindex="-1"></a>F_haps <span class="ot">&lt;-</span> <span class="cf">function</span>(gen){</span>
<span id="cb6-2"><a href="linkage-disequilibrium.html#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="linkage-disequilibrium.html#cb6-3" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="fu">pullSegSiteHaplo</span>(<span class="at">pop =</span> POP[[gen]], <span class="at">haplo =</span> <span class="st">&quot;all&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="linkage-disequilibrium.html#cb6-4" tabindex="-1"></a>      <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">paste</span>(<span class="st">&#39;loc&#39;</span>, <span class="fu">str_pad</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>), <span class="at">sep =</span> <span class="st">&#39;_&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="linkage-disequilibrium.html#cb6-5" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&#39;IG&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="linkage-disequilibrium.html#cb6-6" tabindex="-1"></a>      <span class="fu">separate</span>(IG, <span class="fu">c</span>(<span class="st">&#39;IND&#39;</span>, <span class="st">&#39;HAP&#39;</span>), <span class="st">&#39;_&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="linkage-disequilibrium.html#cb6-7" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">GEN =</span> gen <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb6-8"><a href="linkage-disequilibrium.html#cb6-8" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="linkage-disequilibrium.html#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="linkage-disequilibrium.html#cb6-10" tabindex="-1"></a>df_haps <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">31</span>, <span class="at">FUN =</span> F_haps))</span></code></pre></div>
</div>
<div id="un-linked-loci" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Un-linked loci<a href="linkage-disequilibrium.html#un-linked-loci" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With the haplotypes in order, we first looked at two loci that should be un-linked, or in ‘linkage equilibrium’. Loci 2 and 9 were chosen as an example. If we recall from introductory genetics, rather than being a measure of physical distance (NB: base pairs), Morgans are a measure of recombination frequency. As such, the Morgans in which the simulated genome was developed are equivalent to the recombination frequency variable ‘c’ in the text. If we recall from the text, recombination frequencies have a maximum value of 0.5. At this value, the loci are un-linked and segregate as if on separate chromosomes. Loci 2 and 9 are 0.7 Morgans distant from one another and as such should exhibit a recombination frequency approaching 0.5. The exercise was designed to be repeated by simply specifying different loci as shown below. All loci combinations greater than 0.5 Morgans distant from one another should exhibit recombination frequencies near to 0.5.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="linkage-disequilibrium.html#cb7-1" tabindex="-1"></a>loc_A <span class="ot">&lt;-</span> <span class="st">&#39;loc_02&#39;</span></span>
<span id="cb7-2"><a href="linkage-disequilibrium.html#cb7-2" tabindex="-1"></a>loc_B <span class="ot">&lt;-</span> <span class="st">&#39;loc_09&#39;</span></span></code></pre></div>
<p>With the loci specified, take a close look at the following code. We start with the haplotypes data frame and select only the generation and specified loci columns. We then grouped the data by generation and summarized the gene frequencies of the specified loci. Because alleles are labeled as 0s and 1s the frequency of the 1 allele can be achieved by summing all rows and dividing by the total number of rows. The across function was used here to perform the operation on all columns (other than the grouping column). This simply makes the script adaptable to other loci combinations. Once the 1 allele frequencies were calculated for each generation, they were designated as pA (0) and pB (1) to conform with table 1.5 from the text. qA and qB were then calculated with the knowledge that <code>p + q = 1</code>. With the gene frequencies calculated, r, s, t, and u equilibrium frequencies were calculated according to table 1.5. The first few generations of the data frame are shown for reference.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="linkage-disequilibrium.html#cb8-1" tabindex="-1"></a>df_haps_1 <span class="ot">&lt;-</span> df_haps <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="linkage-disequilibrium.html#cb8-2" tabindex="-1"></a>  <span class="fu">select</span>(GEN, loc_A, loc_B) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="linkage-disequilibrium.html#cb8-3" tabindex="-1"></a>  <span class="fu">group_by</span>(GEN) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="linkage-disequilibrium.html#cb8-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="linkage-disequilibrium.html#cb8-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pA =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="sc">!!</span><span class="fu">as.name</span>(loc_A),</span>
<span id="cb8-6"><a href="linkage-disequilibrium.html#cb8-6" tabindex="-1"></a>         <span class="at">qA =</span> <span class="sc">!!</span><span class="fu">as.name</span>(loc_A)) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="linkage-disequilibrium.html#cb8-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pB =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="sc">!!</span><span class="fu">as.name</span>(loc_B),</span>
<span id="cb8-8"><a href="linkage-disequilibrium.html#cb8-8" tabindex="-1"></a>         <span class="at">qB =</span> <span class="sc">!!</span><span class="fu">as.name</span>(loc_B)) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="linkage-disequilibrium.html#cb8-9" tabindex="-1"></a>  <span class="fu">select</span>(GEN, pA, qA, pB, qB) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="linkage-disequilibrium.html#cb8-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r_eq =</span> pA <span class="sc">*</span> pB,</span>
<span id="cb8-11"><a href="linkage-disequilibrium.html#cb8-11" tabindex="-1"></a>         <span class="at">s_eq =</span> pA <span class="sc">*</span> qB,</span>
<span id="cb8-12"><a href="linkage-disequilibrium.html#cb8-12" tabindex="-1"></a>         <span class="at">t_eq =</span> qA <span class="sc">*</span> pB,</span>
<span id="cb8-13"><a href="linkage-disequilibrium.html#cb8-13" tabindex="-1"></a>         <span class="at">u_eq =</span> qA <span class="sc">*</span> qB) <span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="linkage-disequilibrium.html#cb8-14" tabindex="-1"></a>  <span class="fu">round</span>(., <span class="dv">2</span>)</span></code></pre></div>
<div class="tabwid"><style>.cl-e43892b4{}.cl-e4160e38{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e4233158{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e42390da{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e4239102{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e423910c{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-e43892b4'><thead><tr style="overflow-wrap:break-word;"><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">GEN</span></p></th><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">pA</span></p></th><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">qA</span></p></th><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">pB</span></p></th><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">qB</span></p></th><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">r_eq</span></p></th><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">s_eq</span></p></th><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">t_eq</span></p></th><th class="cl-e42390da"><p class="cl-e4233158"><span class="cl-e4160e38">u_eq</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.50</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.50</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.25</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.25</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.25</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.25</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">1</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.51</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.49</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.26</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.26</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.24</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.24</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">2</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.52</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.48</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.26</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.26</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.24</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.24</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">3</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.52</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.48</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.26</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.26</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.24</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.24</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">4</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.53</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.47</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.27</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.27</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.23</span></p></td><td class="cl-e4239102"><p class="cl-e4233158"><span class="cl-e4160e38">0.23</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">5</span></p></td><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">0.53</span></p></td><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">0.47</span></p></td><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">0.5</span></p></td><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">0.26</span></p></td><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">0.27</span></p></td><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">0.23</span></p></td><td class="cl-e423910c"><p class="cl-e4233158"><span class="cl-e4160e38">0.24</span></p></td></tr></tbody></table></div>
<p>If we look at the data we see that each row is a generation and we now have the gene frequencies of both alleles for the two loci and the their expected equilibrium gamete frequencies. If we again turn to table 1.5 we find that rows 2 and 4 have been calculated. The main difference being that we have done this for 30 generations rather than just 1. It is a bit cumbersome in ‘wide format’ but useful to visualizing each step in the calculations. The following script continues by first adding rows 5, the actual gametic frequencies, to the table. The differences from equilibrium (row 6) are then determined before calculating both D and Dmax. A more thorough description is provided below .</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="linkage-disequilibrium.html#cb9-1" tabindex="-1"></a>df_haps_2 <span class="ot">&lt;-</span> df_haps <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="linkage-disequilibrium.html#cb9-2" tabindex="-1"></a>  <span class="fu">select</span>(GEN, loc_A, loc_B) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="linkage-disequilibrium.html#cb9-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GAM_gt =</span> <span class="fu">case_when</span>(<span class="sc">!!</span><span class="fu">as.name</span>(loc_A) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">as.name</span>(loc_B) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&#39;r&#39;</span>,</span>
<span id="cb9-4"><a href="linkage-disequilibrium.html#cb9-4" tabindex="-1"></a>                            <span class="sc">!!</span><span class="fu">as.name</span>(loc_A) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">as.name</span>(loc_B) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&#39;s&#39;</span>,</span>
<span id="cb9-5"><a href="linkage-disequilibrium.html#cb9-5" tabindex="-1"></a>                            <span class="sc">!!</span><span class="fu">as.name</span>(loc_A) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">as.name</span>(loc_B) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&#39;t&#39;</span>,</span>
<span id="cb9-6"><a href="linkage-disequilibrium.html#cb9-6" tabindex="-1"></a>                            <span class="sc">!!</span><span class="fu">as.name</span>(loc_A) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">as.name</span>(loc_B) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&#39;u&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="linkage-disequilibrium.html#cb9-7" tabindex="-1"></a>  <span class="fu">group_by</span>(GEN, GAM_gt) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="linkage-disequilibrium.html#cb9-8" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">FREQ_obs =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="linkage-disequilibrium.html#cb9-9" tabindex="-1"></a>  <span class="fu">group_by</span>(GEN) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="linkage-disequilibrium.html#cb9-10" tabindex="-1"></a>  <span class="fu">spread</span>(<span class="at">key =</span> GAM_gt, <span class="at">value =</span> FREQ_obs) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="linkage-disequilibrium.html#cb9-11" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="linkage-disequilibrium.html#cb9-12" tabindex="-1"></a>  <span class="fu">merge</span>(., df_haps_1, <span class="at">by =</span> <span class="st">&#39;GEN&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="linkage-disequilibrium.html#cb9-13" tabindex="-1"></a>  <span class="fu">select</span>(GEN, pA, qA, pB, qB, r_eq, s_eq, t_eq, u_eq, r, s, t, u) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="linkage-disequilibrium.html#cb9-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dr =</span> r <span class="sc">-</span> r_eq,</span>
<span id="cb9-15"><a href="linkage-disequilibrium.html#cb9-15" tabindex="-1"></a>         <span class="at">Ds =</span> s <span class="sc">-</span> s_eq,</span>
<span id="cb9-16"><a href="linkage-disequilibrium.html#cb9-16" tabindex="-1"></a>         <span class="at">Dt =</span> t <span class="sc">-</span> t_eq,</span>
<span id="cb9-17"><a href="linkage-disequilibrium.html#cb9-17" tabindex="-1"></a>         <span class="at">Du =</span> u <span class="sc">-</span> u_eq) <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="linkage-disequilibrium.html#cb9-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">D =</span> (r<span class="sc">*</span>u) <span class="sc">-</span> (s<span class="sc">*</span>t)) <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="linkage-disequilibrium.html#cb9-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dmax =</span> <span class="fu">ifelse</span>(s_eq <span class="sc">&lt;=</span> t_eq, D <span class="sc">/</span> s_eq, D <span class="sc">/</span> t_eq)) <span class="sc">%&gt;%</span></span>
<span id="cb9-20"><a href="linkage-disequilibrium.html#cb9-20" tabindex="-1"></a>  <span class="fu">round</span>(., <span class="dv">2</span>)</span></code></pre></div>
<div class="tabwid"><style>.cl-e4c165da{}.cl-e4a071cc{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e4acce54{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e4ad110c{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e4ad1120{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e4ad112a{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-e4c165da'><thead><tr style="overflow-wrap:break-word;"><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">GEN</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">r</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">s</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">t</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">u</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">Dr</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">Ds</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">Dt</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">Du</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">D</span></p></th><th class="cl-e4ad110c"><p class="cl-e4acce54"><span class="cl-e4a071cc">Dmax</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.50</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.00</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.00</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.50</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.25</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.25</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.25</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.25</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.25</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">1.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">1</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.38</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.13</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.11</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.37</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.12</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.13</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.13</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.13</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.13</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.54</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">2</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.33</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.19</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.17</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.31</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.07</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.07</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.07</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.07</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.07</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.29</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">3</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.29</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.24</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.21</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.27</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.03</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.02</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.03</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.03</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.03</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.11</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">4</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.29</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.24</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.21</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.26</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.02</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.03</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.02</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.03</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.02</span></p></td><td class="cl-e4ad1120"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.10</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">5</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.27</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.26</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.23</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.25</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.01</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">-0.01</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.00</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.01</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.01</span></p></td><td class="cl-e4ad112a"><p class="cl-e4acce54"><span class="cl-e4a071cc">0.03</span></p></td></tr></tbody></table></div>
<p>The code is a bit complicated, especially if your new to R programming. It begins with the haplotype data frame and again we selected only generation and the two loci of interest. A column denoting actual gametic types, or <code>gam_gt</code> was then added be defining a number of ‘cases’. The cases relate to an individual’s combination of alleles at the specified loci. For example, 0 at loc_A and 0 at loc_B equates to ‘r’. The designations correspond to the gametic type in row 3 of table 1.5.</p>
<p>With r, s, t, and u specified the data was grouped by generation and gametic type to determine the frequency of gametic types in each generation. This was performed by simply taking the number of each type and dividing by 2000, as there were 4 gametic types x 500 individual in each generation. NA values were replaced with 0s and the data frame was converted to wide for merging with the gene and gametic equilibrium frequencies. The <code>select</code> function was used again to get everything in the right order for presentation. The disequilibrium was then determined for each gametic type, and the total disequilibrium calculated using the equation <code>D = ru - st</code>.</p>
<p>In calculating Dmax, values are normalized to the lesser of the repulsion heterozygote equilibroum frequencies. In this way, the largest possible value of D is achieved. The values also correspond to figure 1.3 and equation 1.5. The following code applies the simulated data to both the equation and the figure. First, the <code>nls</code> function is used to fit equation 1.5 to the data. Then Dmax as a function of generation is plotted graphically. Actual data is shown in points, and modeled data as a line. A summary of the model is also provided to observe the fit and predict recombination frequency (c).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="linkage-disequilibrium.html#cb10-1" tabindex="-1"></a>mod_unlinked <span class="ot">&lt;-</span> <span class="fu">nls</span>(Dmax <span class="sc">~</span> <span class="dv">1</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> c)<span class="sc">^</span>GEN, <span class="at">data =</span> df_haps_2, <span class="at">start =</span> <span class="fu">list</span>(<span class="at">c =</span> <span class="fl">0.5</span>))</span>
<span id="cb10-2"><a href="linkage-disequilibrium.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="linkage-disequilibrium.html#cb10-3" tabindex="-1"></a>df_haps_2 <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="linkage-disequilibrium.html#cb10-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="linkage-disequilibrium.html#cb10-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> GEN, <span class="at">y =</span> <span class="fu">predict</span>(mod_unlinked)),</span>
<span id="cb10-6"><a href="linkage-disequilibrium.html#cb10-6" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="linkage-disequilibrium.html#cb10-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> GEN, <span class="at">y =</span> Dmax),</span>
<span id="cb10-8"><a href="linkage-disequilibrium.html#cb10-8" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="linkage-disequilibrium.html#cb10-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;generations&#39;</span>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="linkage-disequilibrium.html#cb10-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;disequilibrium&#39;</span>) <span class="sc">+</span></span>
<span id="cb10-11"><a href="linkage-disequilibrium.html#cb10-11" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb10-12"><a href="linkage-disequilibrium.html#cb10-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb10-13"><a href="linkage-disequilibrium.html#cb10-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in
## ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see
## where this warning was generated.</code></pre>
<p><img src="bookdownproj_files/figure-html/C01R3_ulmod-1.png" width="624" /></p>
<p>The plot of disequilibrium as a function of generation looks very similar to the c = 0.5 series of figure 1.3 in the text. When presented as Dmax, disequilibrium is 1 in generation 0 and then declines sharply. After 5-6 generations equilibrium has been reached and Dmax oscillates around 0. The slight oscillation is error as a result of the data being determined from simulated genomes and populations. The error can actually be increased/decreased through increases/decreases to the population size. This, however, is a topic of importance for later chapters.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="linkage-disequilibrium.html#cb12-1" tabindex="-1"></a><span class="fu">summary</span>(mod_unlinked)</span></code></pre></div>
<pre><code>## 
## Formula: Dmax ~ 1 * (1 - c)^GEN
## 
## Parameters:
##   Estimate Std. Error t value Pr(&gt;|t|)    
## c  0.46524    0.01515   30.72   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.02846 on 30 degrees of freedom
## 
## Number of iterations to convergence: 3 
## Achieved convergence tolerance: 5.823e-06</code></pre>
<p>We can see from the gray line that despite some error, the model is a good fit for our points. In the summary, we can confirm that it was a ‘highly significant’ fit. We can also clearly see that the equation is the same as equation 1.5 from the text. For this exercise, we are also interested in the calculated value of c, the recombination frequency. Here, we find it to be ~ 0.465 which while not exactly 0.5 is suggestive of two ‘nearly un-linked’ loci.</p>
</div>
<div id="closely-linked-loci" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Closely linked loci<a href="linkage-disequilibrium.html#closely-linked-loci" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After fair success observing un-linked loci, we can now turn our attention to loci in close proximity to one another. For this example, Loci 2 and 3 were chosen but the code was written to try out other combinations. Based on the map of our simulated genome, loci 2 and 3 are 0.1 Morgans apart. If everything went as expected, we should find a recombination frequency near to this value.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="linkage-disequilibrium.html#cb14-1" tabindex="-1"></a>loc_A <span class="ot">&lt;-</span> <span class="st">&#39;loc_02&#39;</span></span>
<span id="cb14-2"><a href="linkage-disequilibrium.html#cb14-2" tabindex="-1"></a>loc_B <span class="ot">&lt;-</span> <span class="st">&#39;loc_03&#39;</span></span></code></pre></div>
<p>After specifying the loci, the code is actually identical to that for the un-linked example. As such, only the table of values, plot of D as a function of generation, and the model results are shown.</p>
<div class="tabwid"><style>.cl-e6421ad0{}.cl-e61de480{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e62b18bc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e62b765e{width:0.29in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e62b767c{width:0.29in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e62b7686{width:0.29in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-e6421ad0'><thead><tr style="overflow-wrap:break-word;"><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">GEN</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">pA</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">qA</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">pB</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">qB</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">r_eq</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">s_eq</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">t_eq</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">u_eq</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">r</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">s</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">t</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">u</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">Dr</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">Ds</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">Dt</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">Du</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">D</span></p></th><th class="cl-e62b765e"><p class="cl-e62b18bc"><span class="cl-e61de480">Dmax</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.50</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.50</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.50</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.50</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.50</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.00</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.00</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.50</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">1.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">1</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.51</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.49</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.51</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.49</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.26</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.24</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.48</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.03</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.03</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.46</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.22</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.22</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.22</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.22</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.22</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.89</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">2</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.52</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.48</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.52</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.48</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.27</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.23</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.46</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.06</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.06</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.42</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.19</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.19</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.19</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.19</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.19</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.77</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">3</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.52</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.48</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.52</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.48</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.27</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.23</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.44</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.08</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.08</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.40</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.17</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.17</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.17</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.17</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.17</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.68</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">4</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.53</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.47</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.53</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.47</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.28</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.22</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.43</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.10</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.10</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.37</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.15</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.15</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.15</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.15</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.15</span></p></td><td class="cl-e62b767c"><p class="cl-e62b18bc"><span class="cl-e61de480">0.60</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">5</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.53</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.47</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.53</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.47</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.28</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.25</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.22</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.41</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.12</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.12</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.35</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.13</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.13</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">-0.13</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.13</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.13</span></p></td><td class="cl-e62b7686"><p class="cl-e62b18bc"><span class="cl-e61de480">0.53</span></p></td></tr></tbody></table></div>
<p>The complete table of values is shown for the first 5 generations. While there are a lot of numbers there, it can be useful to see them all together, For each generation we can see how the gene frequencies (pA…) are used to calculate the gamtetic equilibrium frequencies (r_eq…). The observed gametic frequencies are then derived from the haplotype data of the simulation. The disequilibrium for each gametic type (Dr…) is then calculated by subtracting the equilibrium from the observed gametic frequencies. Next, total disequilibrium (D) is calculated as Dr * Du = Ds * Dt. Finally, Dmax is calculated as D divided by the lesser of the observed repulsion heterozygote frequencies. In the first 5 generations, the decline in Dmax is clearly less than for the un-linked example.</p>
<p><img src="bookdownproj_files/figure-html/C01R3_linked_plot-1.png" width="624" /></p>
<p>The graphic more clearly illustrates the more gradual reduction in disequilibrium. As a reference, the un-linked model (c = 0.5) was included in the plot. Rather than reaching equilibrium in 5-6 generations, upwards of 25+ generations were required for loci 2 and 3. Linkage between the two loci is clearly present.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="linkage-disequilibrium.html#cb15-1" tabindex="-1"></a><span class="fu">summary</span>(mod_linked)</span></code></pre></div>
<pre><code>## 
## Formula: Dmax ~ 1 * (1 - c)^GEN
## 
## Parameters:
##   Estimate Std. Error t value Pr(&gt;|t|)    
## c 0.103889   0.002805   37.04   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04227 on 30 degrees of freedom
## 
## Number of iterations to convergence: 8 
## Achieved convergence tolerance: 2.359e-06</code></pre>
<p>As was the case for the un-linked model, the linked model also demonstrated a highly significant fit. An estimated recombination frequency of c = 0.111 was also very close to our anticipated value of 0.1. The two loci are clearly in linkage disequilibrium.</p>
</div>
<div id="conclusion" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Conclusion<a href="linkage-disequilibrium.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While the exercise was developed as a demonstration of disequilibrium and the derivation of its magnitude, it also indirectly validated the AlphaSimR software. AlphaSimR is indeed an extremely useful program to practitioners of population and quantitative genetics. In fact, we will make use of it throughout the entire course. As such, take a long look at the code behind the operations and run a few experiments yourself. First try a few different loci combinations and see if the recombination frequency aligns with the map distance In Morgans. If you’re more ambitious, change the population size and see how this effects the results (NB: model error). As alluded to previously, population size will be a re-occurring theme throughout the course so there is no time like the present to get started!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="random-drift-in-the-idealized-population.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pura-acuicultura/quantitative_genetics/edit/main/02-linkage_disequilibrium.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/pura-acuicultura/quantitative_genetics/blob/main/02-linkage_disequilibrium.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
